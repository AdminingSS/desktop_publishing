"use strict";var _createClass=function(){function a(e,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||false;d.configurable=true;if("value" in d){d.writable=true}Object.defineProperty(e,d.key,d)}}return function(d,b,c){if(b){a(d.prototype,b)}if(c){a(d,c)}return d}}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function _classCallCheck(a,b){if(!(a instanceof b)){throw new TypeError("Cannot call a class as a function")}}(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if((typeof exports==="undefined"?"undefined":_typeof(exports))==="object"){module.exports=a(require("jquery"))}else{a(jQuery)}}})(function(a){var b=function(){function v(y){_classCallCheck(this,v);this.block=y.block;this.content=y.content||"";this.tooltipPosition=y.position||"bottom";this.extraMargin=y.extraMargin||5;this.showAnimation=y.showAnimation||"fade";this.hideAnimation=y.hideAnimation||"fade";this.showAnimationSpeed=y.showAnimationSpeed||200;this.hideAnimationSpeed=y.hideAnimationSpeed||200;this.customContainerClass=y.customContainerClass||"";this.tpl={tooltipContainer:'<div class="jtooltip"></div>',tooltipInner:'<div class="jtooltip-inner"></div>',tooltipArrow:'<div class="jtooltip-arrow animated bounce"></div>'};this.events={beforeOpen:"jTooltip:beforeOpen",afterOpen:"jTooltip:afterOpen",beforeClose:"jTooltip:beforeClose",afterClose:"jTooltip:afterClose"};this.init()}_createClass(v,[{key:"init",value:function w(){if(!this.block){return}var y=this.showAnimationSpeed+this.hideAnimationSpeed+20;this.$block=a(this.block);this._addTooltipHandler=this.debounce(this.addTooltipHandler,y).bind(this);this._removeTooltipHandler=this.removeTooltipHandler.bind(this);this.content=this.content||this.block.getAttribute("data-jtooltip-title")||this.block.getAttribute("title")||this.block.getAttribute("name");a(this.block).on({mouseenter:this._addTooltipHandler,mouseleave:this._removeTooltipHandler});this.running=true}},{key:"addTooltipHandler",value:function x(y){y.preventDefault();var z=this.$block.attr("title");if(z){this.$block.removeAttr("title").attr("data-cached-title",z)}this.addTooltip()}},{key:"removeTooltipHandler",value:function c(y){y.preventDefault();var z=this.$block.attr("data-cached-title");if(z){this.$block.removeAttr("data-cached-title").attr("title",z)}this.removeTooltip()}},{key:"addTooltip",value:function r(){this.renderTooltip();this.setTooltipPos(this.tooltipPosition);this.showTooltip()}},{key:"renderTooltip",value:function n(B){var z=this.$tooltip=a(this.tpl.tooltipContainer);var D=this.$inner=a(this.tpl.tooltipInner);var y=this.$arrow=a(this.tpl.tooltipArrow);var A=this.content;var C=this.getPartialClass(this.block,"js__jtooltip-s_")||"";D.append(A);z.append(D).append(y).addClass(C).addClass(this.customContainerClass).appendTo("body");if(B){z.hide()}}},{key:"setTooltipPos",value:function s(K,y){var A=this.tooltipPosition;var I=this.getAvailiablePos(K);var G=false;var N=this.getCoords(this.block);var E=this.$tooltip;var L=this.$arrow;var C=this.extraMargin;var J=null;var z=null;var F="";var B={};E.show();var D=E.outerWidth();var M=E.outerHeight();if(!I&&!y){var H="";switch(K){case"top":if(A===K){H="bottom"}else{if(A==="bottom"){H="right"}else{if(A==="left"||A==="right"){H=A;G=true}}}break;case"right":if(A==="left"){H="bottom"}else{H="left"}break;case"bottom":if(A==="top"){H="right"}else{H="top"}break;case"left":if(A===K){H="right"}else{if(A==="right"){H="bottom"}else{if(A==="top"||A==="bottom"){H=A;G=true}}}break}this.setTooltipPos(H,G);return}switch(K){case"top":J=N.top-(M+C);z=this.getCenterTooltip(K);B=this.getArrowCenter(K,z);F="jtooltip-t";break;case"right":J=this.getCenterTooltip(K);z=N.right+C;B=this.getArrowCenter(K,J);F="jtooltip-r";break;case"bottom":J=N.bottom+C;z=this.getCenterTooltip(K);B=this.getArrowCenter(K,z);F="jtooltip-b";break;case"left":J=this.getCenterTooltip(K);z=N.left-(D+C);B=this.getArrowCenter(K,J);F="jtooltip-l";break}E.addClass(F).css({left:z+"px",top:J+"px"});L.css(B.propName,B.propVal);E.hide()}},{key:"getAvailiablePos",value:function l(F){var z=this.getCoords(this.block);var E=this.getViewportCoords();var D=this.extraMargin;var A=this.$tooltip;var B=A.outerWidth()+D;var C=A.outerHeight()+D;var y=false;switch(F){case"top":y=z.top-E.top>=C;break;case"right":y=E.right-z.right>=B;break;case"bottom":y=E.bottom-z.bottom>=C;break;case"left":y=z.left-E.left>=B;break}return y}},{key:"getCenterTooltip",value:function g(G){var z=this.getCoords(this.block);var C=this.getViewportCoords();var E=this.$tooltip;var D=E.outerWidth();var I=E.outerHeight();var B=0;if(G==="top"||G==="bottom"){B=z.left+z.width/2;var H=B-D/2>=C.left;var A=B+D/2<=C.right;if(!H||C.width<=D){return C.left}else{if(!A){return C.right-D}}return B-D/2}else{B=z.top+z.height/2;var F=B-I/2>=C.top;var y=B+I/2<=C.bottom;if(!F||C.height<=I){return C.top}else{if(!y){return C.bottom-I}}return B-I/2}}},{key:"getArrowCenter",value:function p(z,I){var H=this.$arrow;var B=this.getCoords(H[0]);var J=this.getCoords(this.block);var C=0;var F=0;var D=0;var E="";var A="";var y="";var G="";if(z==="top"||z==="bottom"){E="left";A="width"}else{E="top";A="height"}D=I-B[E];C=J[E]+J[A]/2;F=B[E]+B[A]/2+D;if(C===F){return}G=H.css(E)!=="auto"?parseFloat(H.css(E)):0;y=G+(C-F)+"px";return{propName:E,propVal:y}}},{key:"removeTooltip",value:function m(){this.hideTooltip(true)}},{key:"showTooltip",value:function f(){var y=this;if(!this.$tooltip.length){return}a(this.block).trigger(this.events.beforeOpen,[this.$tooltip,this]);switch(this.showAnimation){case"simple":this.$tooltip.show();a(this.block).trigger(this.events.afterOpen,[this.$tooltip,this]);break;case"slide":this.$tooltip.slideDown(this.events.showAnimationSpeed,function(){a(y.block).trigger(y.events.afterOpen,[y.$tooltip,y])});break;case"fade":this.$tooltip.fadeIn(this.events.showAnimationSpeed,function(){a(y.block).trigger(y.events.afterOpen,[y.$tooltip,y])});break}}},{key:"hideTooltip",value:function j(A){var z=this;var y=function y(){};if(!this.$tooltip||!this.$tooltip.length){return}if(A){y=this.destoyTooltip.bind(this)}a(this.block).trigger(this.events.beforeClose,[this.$tooltip,this]);switch(this.showAnimation){case"simple":this.$tooltip.hide();y();a(this.block).trigger(this.events.afterClose,[this.$tooltip,this]);break;case"slide":this.$tooltip.slideUp(this.hideAnimationSpeed,function(){y();a(z.block).trigger(z.events.afterClose,[z.$tooltip,z])});break;case"fade":this.$tooltip.fadeOut(this.hideAnimationSpeed,function(){y();a(z.block).trigger(z.events.afterClose,[z.$tooltip,z])});break}}},{key:"destoyTooltip",value:function h(){this.$tooltip.remove();this.$tooltip=null;this.$inner=null;this.$arrow=null}},{key:"getCoords",value:function t(A){var z=A.getBoundingClientRect();var y=document.documentElement;return{top:z.top+window.pageYOffset||y.scrollTop,right:z.right+window.pageXOffset||y.scrollLeft,bottom:z.bottom+window.pageYOffset||y.scrollTop,left:z.left+window.pageXOffset||y.scrollLeft,width:A.offsetWidth,height:A.offsetHeight}}},{key:"getViewportCoords",value:function o(){var A=document.documentElement;var C=window.pageYOffset||A.scrollTop;var B=window.pageXOffset||A.scrollLeft;var z=B+A.clientWidth;var y=C+A.clientHeight;return{top:C,right:z,bottom:y,left:B,width:A.clientWidth,height:A.clientHeight}}},{key:"getPartialClass",value:function q(B,y){var C=B.className;var A=C.indexOf(y);if(!~A){return null}var z=~C.indexOf(" ",A)?C.indexOf(" ",A):undefined;return C.slice(A,z)}},{key:"debounce",value:function e(z,y){var A=false;function B(){if(A){return}z.apply(this,arguments);A=true;setTimeout(function(){A=false},y)}return B}},{key:"getSelf",value:function d(){return this}},{key:"stop",value:function u(){if(!this.running){return}a(this.block).off({mouseenter:this._addTooltipHandler,mouseleave:this._removeTooltipHandler});this.running=false}},{key:"start",value:function i(){if(this.running){return}a(this.block).on({mouseenter:this._addTooltipHandler,mouseleave:this._removeTooltipHandler});this.running=true}},{key:"preventDef",value:function k(y){y.preventDefault()}}]);return v}();a.fn.jTooltip=function(){var f=this;var e=arguments[0]||{};var d=Array.prototype.slice.call(arguments,1);for(var g=0;g<f.length;g++){if((typeof e==="undefined"?"undefined":_typeof(e))==="object"){e.block=f[g];f[g].jTooltip=new b(e)}else{var c=f[g].jTooltip[e].call(f[g].jTooltip,d);if(typeof c!=="undefined"){return c}}}return f}});